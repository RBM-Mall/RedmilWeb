@model BusinessReportModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@using Project_Redmil_MVC
@using Project_Redmil_MVC.Models
@{
    ViewData["Title"] = "Business Report - Online My Business Report";
    Layout = "~/Pages/Shared/_LayoutMaster.cshtml";
}
<link rel="stylesheet" href="~/css/businessReport.css" asp-append-version="true" />
<link rel="stylesheet" href="~/css/dataTables.bootstrap4.min.css" asp-append-version="true" />
<script src="/lib/jquery/dist/jquery.js"></script>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/rechargejs/recharge.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"> 
<script src="jquery.redirect.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="~/css/navbarheader.css">
<link href="~/ResponsiveCSS/Index.css" rel="stylesheet" />
<link href="~/ResponsiveCSS/jQueryTable.css" rel="stylesheet" />
<link rel="stylesheet" href="~/servicesCSS/prepaidrecharge.css" asp-append-version="true" />
<link href="https://cdn.datatables.net/rowreorder/1.3.2/css/rowReorder.dataTables.min.css" rel="stylesheet" />
<link href="https://cdn.datatables.net/responsive/2.4.0/css/responsive.dataTables.min.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.13.2/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/rowreorder/1.3.2/js/dataTables.rowReorder.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.4.0/js/dataTables.responsive.min.js"></script>
<link href="~/ResponsiveCSS/ServicesNavigation.css" rel="stylesheet" />

<br />

<div class="container-fluid" style="background:white">
    @*<div class="first-header">
    <div class="section make_tomorrow_digital background-image" style="background-image: linear-gradient(225deg, #003366 0%, #345beb 49%, #5634eb 100%); background-size: cover;height:150px;">
    <div class="container">
    <div class="row">
    <div class="col-sm-12">
    <div class="call-to-action">
    <div class="row">
    <div class="col-sm-7 col-xs-12 dmt">
    <h3 class="padding-left-right-50 " style="margin-top: 20px; margin-left:300px;text-align:center; font-weight: 700; cursor: pointer;"><u>Business Reports</u></h3>
    <br />
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>*@
    @*<hr />
    <div>
    <div class="col col-md-12 col-sm-12 col-lg-12">
    <img src="/css/Img_BusinessReport/report11N.jpg" style="width: 100%;" alt="Norway" />
    </div>
    </div>
    <hr />
    <br />*@
    <div class="div_get_info">
        <h2 class="tag">Get Complete Transparency & Keep Good Track Of Your Business Transactions With Business Reports</h2>
    </div>
    <hr />
    <div class="section services-area padding-top-bottom-60">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 text-center padding-bottom-30">
                    <div>
                        <h2 class="heading_businessRepo">Choose Category And Subcategory For Business Report</span></h2>
                    </div>
                </div>
            </div>
            <div class="row rowaepsChooseTrasaction_BusinessRepo" id="aepsChooseTrasaction">
                <div class="row">
                    <div class="col col-md-6 col-sm-6">
                        <div class="col-md-4 col-sm-4" style="margin-left: 30px;">
                            <h4 class="heading_choose_businessrepo">Category</h4>

                        </div>
                        <div class="col-md-4 col-sm-4 select_category_ddl">
                            @if (ViewBag.Caterory != null)
                            {
                                @Html.DropDownListFor(m =>m.Id , ViewBag.Caterory as SelectList , "-- Select Categories --" ,  new {@class="form-control select_category_ddl_1"})
                            }
                        </div>

                        <br />
                        <h5><span id="errCategory" style="color:red" class="errorMsg"></span></h5>
                    </div>
                    <div class="col col-md-6 col-sm-6">
                        <div class="col-md-4 col-sm-4" style="margin-left: 30px;">
                            <h4 class="heading_choose_businessrepo">Sub Category</h4>
                        </div>
                        <div class="col-md-4 col-sm-4 select_category_ddl">
                            <select class="form-control select_category_ddl_1" id="SId" name="Id" asp-for="Id"
                                                    asp-items="@(new SelectList(string.Empty,"Id","Title"))"></select>
                        </div>
                        <br />
                        <h5><span id="errSubCategory" style="color:red" class="errorMsg"></span></h5>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="walletTblborder11" style="display:none;" id="walletTblborder11">
                <div id="transRepoTbl11" style="margin-top: 20px;height: 100%; overflow: auto;width: 100%;display:block; padding-left: 50px;padding-right: 50px; border-radius: 2px">
                    @*<h2 id="headingReport" class="transRepoHead text-center" style="margin-bottom: 80px;text-decoration: underline;color: #2d385e;">*@
                    <h2 id="headingReport" class="transRepoHead text-center">
                    </h2>
                    <div class="row" id="divHeading" style="display:block">
                        <table id="tempTbl" border="0" cellspacing="5" cellpadding="5" class="table table-striped align-middle table-bordered table-responsive caption-top" style="margin-top: 40px; ">
                            <caption style="margin-top: 10px;"><u> List Of Transaction Details</u></caption>
                            <tbody class="filterDate pull-right">
                                <div class="row div_SortBy">
                                    <div class="col col-md-3">
                                        <div class="form-group-recharge">
                                            <label class="dateLbl"><b>From Date:</b></label>
                                            <input class="inputDate form-control" type="date" name="" max="" id="fromDate" />
                                            <br />
                                            <h5>
                                                <span id="errfromDate" style="color:red" class="errorMsg"></span>
                                            </h5>
                                        </div>
                                    </div>
                                    <div class="col col-md-3">
                                        <div class="form-group-recharge">
                                            <label class="dateLbl"><b>To Date:</b></label>
                                            <input class="inputDate form-control" type="date" name="" min="" id="toDate" />
                                            <br />
                                            <h5>
                                                <span id="errtoDate" style="color:red" class="errorMsg"></span>
                                            </h5>
                                        </div>
                                    </div>
                                    <div class="col col-md-2">
                                        <button type="button" class="buttonDownload" style="display:none;margin-left:60px;background: cadetblue;font-weight: 800;" id="btnFilterByDate">Filter By Date</button>
                                    </div>
                                    @*<div class="col col-md-2">*@
                                    @*<div class="form-group-recharge">
                                    <label class="dateLbl"><b>Sort:</b></label>*@
                                    @*<select class="busiRepo_status" id="ddlStatusName" onclick="ddlStatusName()">*@
                                    @*<select class="busiRepo_status" id="ddlStatusName">
                                    Sort By Status
                                    <i class="fa fa-angle-down">@*--Select--</i>
                                    @*<option value="0">--Sort By Status--</option>*@
                                    @*<option value="0">--Sort By Status--</option>*@
                                    @*<option value="2">Failure</option>
                                    <option value="3">NA</option>
                                    <option value="4">Pending</option>
                                    <option value="5">Success</option>
                                    </select>*@

                                    @*<div class="form-group-recharge">*@
                                    @* <div class="">
                                    <div class="">
                                    <div class="">
                                    <select class="inputDate form-control ddlStatusName" id="ddlStatus" name="Id" asp-for="Id"
                                    asp-items="@(new SelectList(string.Empty,"Id","Title"))">
                                    <option value="0">--Select Status--</option>
                                    <option value="1">--Hello Status--</option>
                                    </select>
                                    </div>
                                    </div>
                                    </div>*@
                                    @*</div>
                                    </div>*@
                                    <div class="col col-md-2">
                                        <div class="form-group-recharge">
                                            <button type="button" class="buttonDownload pull-right" onclick="documentDownload()" id="transactionReportDownload">Download</button>
                                        </div>
                                    </div>
                                </div>
                                <hr />
                            </tbody>
                        </table>
                    </div>
                    @*<table id="tempTbl1" mode="static" class="table table-striped table-bordered table-responsive wrapper dataTable no-footer responsive_table_businessRepo" border="1" cellspacing="3" cellpadding="3" style="margin-top:-85px;background:#f3f3f3;margin-left: 15px;">*@
                    <div id="temptableid"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    const ourItemDiv = document.getElementsByClassName("item");
    const openIcon = document.getElementsByClassName("iconOpen");
    const closeIcon = document.getElementsByClassName("iconClose");
    for (let i = 0; i < ourItemDiv.length; i++) {
        closeIcon[i].style.display = "none";

        ourItemDiv[i].addEventListener("click", () => {
            const result = ourItemDiv[i].classList.toggle("active");

            if (result) {
                closeIcon[i].style.display = "block";
                openIcon[i].style.display = "none";
            }
            else {
                closeIcon[i].style.display = "none";
                openIcon[i].style.display = "block";
            }
        });
    }

</script>

<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
<script>

    $(document).ready(function () {

        $("#Id").change(function () {
            var CatId = $(this).val();
            $.ajax({
                type: "POST",
                url: "/MyBusinessReports/SubCategoryReports?Id=" + CatId,
                contentType: "html",
                success: function (response) {
                    if (response.result == "EmptyResult") {
                        window.location.href = response.url;
                    }
                    else if (response.result == "UnExpectedStatusCode") {
                        window.location.href = response.url;
                    }
                    else if (response.result == "RedirectToException") {
                        window.location.href = response.url;
                    }
                    else {
                        $('#SId').html('');

                        var options = '';

                        for (var i = 0; i < response.length; i++) {

                            options += '<option value="' + response[i].value + '">' + response[i].text + '</option>';

                        }
                        $('#SId').append(options);
                    }
                }
            });
        });
    });


    //Method for first subcategory select without any filter

    $("#SId").change(function () {
        
        document.getElementById("errfromDate").innerHTML = "";
        document.getElementById("errtoDate").innerHTML = "";
        document.getElementById("fromDate").value = '';
        document.getElementById("toDate").value = '';
        var e = $('#SId').val();
        var f = $('#Id').val();

        var service = $('#SId').text;
        $("#ddlStatus").val(0);

        $.ajax({
            type: "POST",
            url: "/MyBusinessReports/GetTransactionReports?subCat=" + e,
            contentType: "json",
            success: function (response) {
                if (response.result == "EmptyResult") {
                    window.location.href = response.url;
                }
                else if (response.result == "UnExpectedStatusCode") {
                    window.location.href = response.url;

                }
                else if (response.result == "RedirectToException") {
                    window.location.href = response.url;
                }
                else if (response.result == "PanCard") {
                    window.location.href = response.url;

                }
                else if (response.result == "RedirectToBooking") {
                    window.location.href = response.url;
                }
                else {
                    
                    var table = $('#tempTbl1').DataTable();
                    table.destroy();
                    $("#temptableid").find("table").remove();
                    var tr = '<table id="tempTbl1" mode="static" class="table table-striped table-bordered table-responsive wrapper dataTable no-footer responsive_table_businessRepo" border="1" cellspacing="3" cellpadding="3"><thead><tr>';
                    var columnName = Object.keys(response[0]);
                    for (var i = 0; i <= columnName.length; i++) {

                        if (i == columnName.length && f != 7 && f != 3) {
                            tr += '<th class="business_Repo_Table_Header">Action</th>'
                        }
                        else if (i == columnName.length && (f == "7" || f == "3")) { }
                        else {
                            tr += '<th class="business_Repo_Table_Header">' + columnName[i].replace(/([a-z0-9])([A-Z])/g, '$1 $2').toUpperCase() + '</th>'
                        }
                    }
                    tr += '</tr></thead>';
                    tr += '<tbody id="output">';


                    for (var i = 0; i < response.length; i++) {
                        tr += '<tr>'
                        var columnValue = Object.values(response[i]);
                        for (var j = 0; j <= columnValue.length; j++) {
                            if (j == 0) {
                                tr += '<td class="business_Repo_Table_td">' + (i + 1) + '</td>'
                            }

                            else if (j == columnValue.length && f != 7 && f != 3) {
                                if (f == 2) {
                                    tr += '<td class="business_Repo_Table_td"><button style="background:#4CC713;color:white" id=1' + i + ' class="btnViewReceipt">Button1</button><button style="background:#4CC713;color:white" id=2' + i + ' class="btnViewReceipt">Button2</button><button style="background:#4CC713;color:white" id=3' + i + ' class="btnViewReceipt">Button3</button></td>'
                                }
                                else {
                                    tr += '<td class="business_Repo_Table_td"><button style="background:#4CC713;color:white" id=1' + i + ' class="btnViewReceipt">View Receipt</button></td>'
                                }
                            }
                            else if (j == columnValue.length && (f == "7" || f == "3")) { }
                            else {
                                tr += '<td class="business_Repo_Table_td">' + columnValue[j] + '</td>'
                            }
                        }
                        tr += '</tr>';
                    }
                    tr += '</tbody></table>';

                    document.getElementById("headingReport").innerHTML = $('#SId :selected').text() + " " + "Report";
                    document.getElementById('walletTblborder11').style.display = "block";
                    $("#temptableid").append(tr);
                    var table = $('#tempTbl1').DataTable({
                        rowReorder: {
                            selector: 'td:nth-child(2)'
                        },
                        responsive: true
                    });
                }
            }
        });
    });
</script>

<script>
    $(document).ready(function () {
        var items = "<option value='0'>-- Select SubCategories --</option>";
        $('#SId').html(items);
    });

    //jquery for table filter by date

    var fromDate;
    $('#fromDate').on('change', function () {
        fromDate = $(this).val();
        $('#toDate').prop('min', function () {
            return fromDate;
        })
    });

    var toDate;
    $('#toDate').on('change', function () {
        toDate = $(this).val();
        $('#fromDate').prop('max', function () {
            return toDate;
        })
    });

</script>
<script>
    $(document).ready(function () {
        $(".ddlStatusName").change(function () {
            document.getElementById("errfromDate").innerHTML = "";
            document.getElementById("errtoDate").innerHTML = "";
            var from = $('#fromDate').val();
            var to = $('#toDate').val();
            var e = $('.ddlStatusName').val();
            var subCat = $('#SId').val();
            var f = $('#Id').val();
            var d = $('#transactionReportDownload').val();

            $.ajax({
                type: "POST",
                url: "/MyBusinessReports/DDLStatus",
                data: { 'sort': e, 'fromdate': from, 'todate': to, 'subCat': subCat },
                type: 'POST',
                dataType: 'json',
                success: function (response) {
                    if (response.result == "EmptyResult") {
                        window.location.href = response.url;
                    }
                    else if (response.result == "UnExpectedStatusCode") {
                        window.location.href = response.url;

                    }
                    else if (response.result == "RedirectToException") {
                        window.location.href = response.url;
                    }
                    else {
                        $("#tempTbl1").find("tr").remove();
                        var tr = '<thead><tr>';
                        var columnName = Object.keys(response[0]);
                        for (var i = 0; i <= columnName.length; i++) {

                            if (i == columnName.length && (f != 7 && f != 3)) {
                                tr += '<th style="padding-left:20px;padding-top:20px;padding-right:25px;padding-bottom:25px;background: #2d385e;color:white;font-weight:700;font-size:18px;text-align:center;">Action</th>'
                            }
                            else if (i == columnName.length && (f == 7 || f == 3)) { }
                            else {
                                tr += '<th style="padding-left:20px;padding-top:20px;padding-right:25px;padding-bottom:25px;background: #2d385e;color:white;font-weight:700;font-size:18px;text-align:center;">' + columnName[i].replace(/([a-z0-9])([A-Z])/g, '$1 $2').toUpperCase() + '</th>'
                            }
                        }
                        tr += '</tr></thead>';
                        tr += '<tbody id="output">';
                        for (var i = 0; i < response.length; i++) {
                            tr += '<tr>'
                            var columnValue = Object.values(response[i]);
                            for (var j = 0; j <= columnValue.length; j++) {
                                if (j == 0) {
                                    tr += '<td style="padding-left:20px;padding-top:20px;padding-right:25px;padding-bottom:25px;font-weight:700;text-align:center;">' + (i + 1) + '</td>'
                                }

                                else if (j == columnValue.length && (f != 7 && f != 3)) {
                                    if (f == 2) {
                                        tr += '<td style="padding-left:20px;padding-top:20px;padding-right:25px;padding-bottom:25px;font-weight:700;text-align:center;"><button style="background:#4CC713;color:white" id=1' + i + ' class="btnViewReceipt">Button1</button><button style="background:#4CC713;color:white" id=2' + i + ' class="btnViewReceipt">Button2</button><button style="background:#4CC713;color:white" id=3' + i + ' class="btnViewReceipt">Button3</button></td>'
                                    }
                                    else {
                                        tr += '<td style="padding-left:20px;padding-top:20px;padding-right:25px;padding-bottom:25px;font-weight:700;text-align:center;"><button style="background:#4CC713;color:white" id=1' + i + ' class="btnViewReceipt">View Receipt</button></td>'
                                    }
                                }
                                else if (j == columnValue.length && (f == 7 || f == 3)) { }
                                else {
                                    tr += '<td style="padding-left:20px;padding-top:20px;padding-right:25px;padding-bottom:25px;font-weight:700;text-align:center;">' + columnValue[j] + '</td>'
                                }
                            }
                            tr += '</tr>';
                        }
                        tr += '</tbody>';
                        $("#tempTbl1").append(tr);
                        document.getElementById("headingReport").innerHTML = $('#SId :selected').text() + " " + "Report";
                        document.getElementById('walletTblborder11').style.display = "block";
                        $("#tempTbl1").dataTable().fnDestroy();
                        var table = $('#tempTbl1').DataTable({
                            rowReorder: {
                                selector: 'td:nth-child(2)'
                            },
                            responsive: true
                        });

                    }
                }
            });
        });
    });
</script>

<!--Sorting Method-->
<script>
    $(document).ready(function () {
        $('#toDate').on('change', function () {
            //toDate = $(this).val();
            var from = $('#fromDate').val();
            var to = $('#toDate').val();
            var e = $('#ddlStatus').val();
            var subCat = $('#SId').val();
            document.getElementById("btnFilterByDate").style.display = "block";
            var d = $('#transactionReportDownload').val();

            $.ajax({
                type: "POST",
                url: "/MyBusinessReports/GetTransactionReports",
                data: { 'sort': e, 'fromdate': from, 'todate': to, 'subCat': subCat },
                type: 'POST',
                dataType: 'json',

                success: function (response) {
                    if (response.result == "EmptyResult") {
                        window.location.href = response.url;
                    }
                    else if (response.result == "UnExpectedStatusCode") {
                        window.location.href = response.url;

                    }
                    else if (response.result == "RedirectToException") {
                        window.location.href = response.url;
                    }
                    else {
                        $("#tempTbl1").find("tr").remove();
                        var tr = '<thead><tr>';
                        var columnName = Object.keys(response[0]);
                        for (var i = 0; i <= columnName.length; i++) {
                            if (i == columnName.length) {
                                tr += '<th style="padding-left:20px;padding-top:20px;padding-right:25px;padding-bottom:25px;background: #2d385e;color:white;font-weight:700;font-size:18px;text-align:center;">Action</th>'
                            }
                            else {
                                tr += '<th style="padding-left:20px;padding-top:20px;padding-right:25px;padding-bottom:25px;background: #2d385e;color:white;font-weight:700;font-size:18px;text-align:center;">' + columnName[i].replace(/([a-z0-9])([A-Z])/g, '$1 $2').toUpperCase() + '</th>'
                            }
                        }
                        tr += '</tr></thead>';
                        tr += '<tbody id="output">';

                        for (var i = 0; i < response.length; i++) {
                            tr += '<tr>'
                            var columnValue = Object.values(response[i]);
                            for (var j = 0; j <= columnValue.length; j++) {
                                if (j == 0) {
                                    tr += '<td style="padding-left:20px;padding-top:20px;padding-right:25px;padding-bottom:25px;font-weight:700;text-align:center;">' + (i + 1) + '</td>'
                                }

                                else if (j == columnValue.length) {
                                    tr += '<td style="padding-left:20px;padding-top:20px;padding-right:25px;padding-bottom:25px;font-weight:700;text-align:center;"><button style="background:#4CC713;color:white;" id=' + i + ' class="btnViewReceipt">View Receipt</button></td>'
                                }
                                else {
                                    tr += '<td style="padding-left:20px;padding-top:20px;padding-right:25px;padding-bottom:25px;font-weight:700;text-align:center;">' + columnValue[j] + '</td>'
                                }
                            }
                            tr += '</tr>';
                        }
                        tr += '</tbody>';
                        document.getElementById("headingReport").innerHTML = $('#SId :selected').text() + " " + "Report";
                        $("#tempTbl1").append(tr);
                        $("#tempTbl1").dataTable().fnDestroy();

                        var table = $('#tempTbl1').DataTable({
                            rowReorder: {
                                selector: 'td:nth-child(2)'
                            },
                            responsive: true
                        });
                    }
                },
            });
        });
    });
</script>

<script>
    function documentDownload() {
        var from = $('#fromDate').val();
        var to = $('#toDate').val();
        var d = "x";
        var subCat = $('#SId').val();
        if (from == '' && to == '') {
            document.getElementById('errfromDate').innerHTML = "Please Select From Date";
            document.getElementById('errtoDate').innerHTML = "Please Select To Date";
        }
        else if (to == '') {
            document.getElementById('errtoDate').innerHTML = "Please Select To Date";
            document.getElementById('errfromDate').innerHTML = "";
        }
        else if (from == '') {
            document.getElementById('errfromDate').innerHTML = "Please Select From Date";
            document.getElementById('errtoDate').innerHTML = "";
        }
        else {
            document.getElementById('errfromDate').innerHTML = "";
            document.getElementById('errtoDate').innerHTML = "";
            $.ajax({
                type: "POST",
                url: "/MyBusinessReports/GetTransactionReports",
                data: { 'download': d, 'fromdate': from, 'todate': to, 'subCat': subCat },
                type: 'POST',
                dataType: 'json',
                success: function (response) {
                    if (response.result == "EmptyResult") {
                        window.location.href = response.url;
                    }
                    else if (response.result == "UnExpectedStatusCode") {
                        window.location.href = response.url;

                    }
                    else if (response.result == "RedirectToException") {
                        window.location.href = response.url;
                    }
                    else {
                        window.open(response);
                    }
                },
            });
        }
    };

    $(document).ready(function () {

        $("#ddlStatus").change(function () {
            var StateID = $(this).val();
            var from = $('#fromDate').val();
            var to = $('#toDate').val();
            var subCat = $('#SId').val();
            $.ajax({
                url: "/MyBusinessReports/DDLStatus",
                data: { 'fromDate': from, 'toDate': to, 'subCat': subCat },
                type: 'POST',
                dataType: 'json',
                success: function (response) {
                    if (response.result == "EmptyResult") {
                        window.location.href = response.url;
                    }
                    else if (response.result == "UnExpectedStatusCode") {
                        window.location.href = response.url;

                    }
                    else if (response.result == "RedirectToException") {
                        window.location.href = response.url;
                    }
                    else {
                        $('#ddlStatus').html('');

                        var options = '<option value="' + 0 + '">' + "--Sort By Status--" + '</option>';

                        for (var i = 0; i < response.length; i++) {

                            options += '<option value="' + response[i].status + '">' + response[i].status + '</option>';

                        }
                        $('#ddlStatus').append(options);
                    }
                }
            });

        });
    });
</script>



<script>
    $(document).ready(function () {
        $("#temptableid").on('click', ".btnViewReceipt", function () {
            var table = $('#tempTbl1').DataTable();
            var d = table.row(this).data();
            var currentRow = $(this).closest('tr');
            var subCat = $('#SId').val();
            // 15
            var requestDate = $('#requestDate').val();
            var requestTime = $('#requestTime').val();
            var status = $('#status').val();

            var customerName = $('#customerName').val();
            var customerMobileNumber = $('#customerMobileNumber').val();
            var customerAadhaarNo = $('#customerAadhaarNo').val();
            var transactionAmount = $('#transactionAmount').val();
            var commissionAmount = $('#commissionAmount').val();
            var balanceAmount = $('#balanceAmount').val();
            var bankName = $('#bankName').val();
            var iin = $('#iin').val();
            var bankRRNNumber = $('#bankRRNNumber').val();
            var npciTransactionId = $('#npciTransactionId').val();
            var redmilTransactionId = $('#redmilTransactionId').val();
            var reason = $('#failureReason').val();

            // 30/29/18/19/9
            var cardHolderName = $('#cardHolderName').val();
            var cardHolderMobileNumber = $('#cardHolderMobileNumber').val();
            var cardType = $('#cardType').val();
            var cardNumber = $('#cardNumber').val();

            // 5
            var caNumber = $('#caNumber').val();
            var billPayAmount = $('#billPayAmount').val();
            var billReferenceId = $('#billReferenceId').val();
            var walletType = $('#walletType').val();

            // get the current row


            if (subCat == "15" || subCat == "16" || subCat == "17") {

                var aePSCashWithdrawalModel = {
                    RequestDate: d[1],
                    RequestTime: d[2],
                    CustomerName: d[3],
                    CustomerMobileNumber: d[4],
                    CustomerAadhaarNo: d[5],
                    Status: d[6],
                    TransactionAmount: d[7],
                    BalanceAmount: d[8],
                    CommissionAmount: d[9],
                    BankName: d[12],
                    IIN: d[13],
                    BankRRNNumber: d[14],
                    NPCITransactionId: d[15],
                    RedmilTransactionId: d[16],
                    FailureReason: d[17],
                    DEName: d[18],
                    DEMobile: d[19],
                }
                //var aePSCashWithdrawalModel = {
                //    RequestDate: currentRow.find('td:eq(1)').text(),
                //    RequestTime: currentRow.find('td:eq(2)').text(),
                //    CustomerName: currentRow.find('td:eq(3)').text(),
                //    CustomerMobileNumber: currentRow.find('td:eq(4)').text(),
                //    CustomerAadhaarNo: currentRow.find('td:eq(5)').text(),
                //    Status: currentRow.find('td:eq(6)').text(),
                //    TransactionAmount: currentRow.find('td:eq(7)').text(),
                //    BalanceAmount: currentRow.find('td:eq(8)').text(),
                //    CommissionAmount: currentRow.find('td:eq(9)').text(),
                //    BankName: currentRow.find('td:eq(12)').text(),
                //    IIN: currentRow.find('td:eq(13)').text(),
                //    BankRRNNumber: currentRow.find('td:eq(14)').text(),
                //    NPCITransactionId: currentRow.find('td:eq(15)').text(),
                //    RedmilTransactionId: currentRow.find('td:eq(16)').text(),
                //    FailureReason: currentRow.find('td:eq(17)').text(),
                //    DEName: currentRow.find('td:eq(18)').text(),
                //    DEMobile: currentRow.find('td:eq(19)').text(),
                //}
            }



            else if (subCat == "30" || subCat == "29" || subCat == "18" || subCat == "9") {
                var microATMCashWithdrawalModel = {
                    RequestDate: d[1],
                    RequestTime: d[2],
                    CardHolderName: d[3],
                    CardHolderMobileNumber: d[4],
                    CardType: d[5],
                    CardNumber: d[6],
                    TransactionAmount: d[7],
                    BalanceAmount: d[8],
                    BankRRNNumber: d[11],
                    NPCITransactionId: d[12],
                    RedmilTransactionId: d[13],
                    FailureReason: d[14],
                    DEName: d[15],
                    DEMobile: d[16],
                    Status: d[10],

                    /*Status: $('#@Html.(m=> m.microATMCashWithdrawalModel.Status)').val()*/
                }
            }

            else if (subCat == "19") {

                var microATMBalanceEnquiryModel = {
                    RequestDate: d[1],
                    RequestTime: d[2],
                    CardHolderName: d[3],
                    CardHolderMobileNumber: d[4],
                    CardType: d[5],
                    CardNumber: d[6],
                    TransactionAmount: d[7],
                    BalanceAmount: d[8],
                    BankRRNNumber: d[10],
                    NPCITransactionId: d[11],
                    RedmilTransactionId: d[12],
                    FailureReason: d[15],
                    DEName: d[13],
                    DEMobile: d[14],
                    Status: d[9],


                }

                //var result = requestDate + '\n' + requestTime + '\n' + cardHolderName + '\n' + cardHolderMobileNumber + '\n' + cardType + '\n' + cardNumber + '\n' + balanceAmount + '\n' + bankRRNNumber + '\n' + npciTransactionId + '\n' + redmilTransactionId + '\n' + failureReason + '\n' + status;
                //alert(result);
            }

            else if (subCat == "21") {

                var yBLDomesticMoneyTransferModel = {
                    RequestDate: d[1],
                    RequestTime: d[2],
                    SenderName: d[3],
                    SenderMobileNumber: d[4],
                    TransactionAmount: d[7],
                    Surcharge: d[8],
                    BankRRNNumber: d[16],
                    RedmilReferenceId: d[15],
                    ReceiverName: d[5],
                    ReceiverMobileNumber: d[6],
                    BankName: d[12],
                    ReceiverAccountNo: d[11],
                    IFSCCode: d[13],
                    TransactionType: d[14],
                    Reason: d[18],
                    DEName: d[19],
                    DEMobile: d[20],
                    Status: d[9],
                }

                //var result = requestDate + '\n' + requestTime + '\n' + cardHolderName + '\n' + cardHolderMobileNumber + '\n' + cardType + '\n' + cardNumber + '\n' + balanceAmount + '\n' + bankRRNNumber + '\n' + npciTransactionId + '\n' + redmilTransactionId + '\n' + failureReason + '\n' + status;
                //alert(result);
            }


            else if (subCat == "23") {

                var creditScoreModel = {
                    RequestDate: d[1],
                    RequestTime: d[2],
                    CustomerName: d[3],
                    CustomerMobileNo: d[4],
                    Status: d[5],
                    AmountPaid: d[6],
                    CommissionAmount: d[7],
                    RedmilTransactionId: d[8],
                    WalletType: d[9],
                    DEName: d[10],
                    DEMobile: d[11],
                    CIBILScorePDFLink: d[12],

                }

                //var result = requestDate + '\n' + requestTime + '\n' + cardHolderName + '\n' + cardHolderMobileNumber + '\n' + cardType + '\n' + cardNumber + '\n' + balanceAmount + '\n' + bankRRNNumber + '\n' + npciTransactionId + '\n' + redmilTransactionId + '\n' + failureReason + '\n' + status;
                //alert(result);
            }
            else if (subCat == "26") {

                var goldInvestmentBuyModel1 = {
                    RequestDate: d[1],
                    RequestTime: d[2],
                    CustomerName: d[3],
                    CustomerMobileNumber: d[4],
                    GoldRatePerGram: d[6],
                    TransactionAmount: d[7],
                    NetAmount: d[7],
                    CustomerID: d[16],
                    OldGoldBalance: d[8],
                    NewGoldBalance: d[9],
                    cusInvoice: d[16],
                    Quantity: d[5],
                    InvoiceId: d[18],
                    RedmilTransactionID: d[17],
                    pan: d[12],
                    BankName: d[15],
                    BankAccountNumber: d[13],
                    IFSC: d[14],
                    DEName: d[20],
                    DEMobile: d[21],
                }


            }

            else if (subCat == "27") {

                var goldInvestmentSellModel1 = {
                    RequestDate: d[1],
                    RequestTime: d[2],
                    CustomerName: d[3],
                    CustomerMobileNumber: d[4],
                    TransactionAmount: d[7],
                    RedmilTransactionID: d[17],
                    InvoiceId: d[18],
                    GoldRatePerGram: d[5],
                    Quantity: d[6],
                    InvoiceId: d[18],
                    CustomerID: d[19],
                    OldGoldBalance: d[8],
                    NewGoldBalance: d[9],
                    cusInvoice: d[19],
                    pan: d[13],
                    BankName: d[16],
                    BankAccountNumber: d[14],
                    IFSC: d[15],
                    BankCharge: d[10],
                    NetAmount: d[11],
                    DEName: d[20],
                    DEMobile: d[21],
                }

            }


            else if (subCat == "31") {
                var finoDMTModel = {
                    BankCharges: d[14],
                    BankName: d[11],
                    BankRRNNumber: d[24],
                    ClientUniqueId: d[8],
                    CommissionAmount: d[15],
                    DeMobile: d[21],
                    DeName: d[20],
                    IfscCode: d[12],
                    Reason: d[19],
                    ReceiverAccountNo: d[10],
                    ReceiverMobileNumber: d[22],
                    ReceiverName: d[9],
                    RedmilReferenceId: d[16],
                    RequestDate: d[1],
                    RequestId: d[7],
                    RequestTime: d[2],
                    SenderMobileNumber: d[4],
                    SenderName: d[3],
                    SrNo: d[0],
                    Status: d[6],
                    Surcharge: d[23],
                    TransactionAmount: d[5],
                    TransactionID: d[18],
                    TransactionType: d[13],
                    WalletType: d[17],
                }

                // var result = requestDate + '\n' + requestTime + '\n' + caNumber + '\n' + billPayAmount + '\n' + billReferenceId + '\n' + redmilTransactionId + '\n' + walletType + '\n' + commissionAmount + '\n' + status;
            }

            else if (subCat == "32") {
                var amazonPayGiftCardModel = {
                    RequestDate: d[1],
                    RequestTime: d[2],
                    ReceiverName: d[3],
                    ReceiverMobileNumber: d[4],
                    ReceiverEmailID: d[5],
                    SenderName: d[8],
                    SenderMobile: d[9],
                    Status: d[6],
                    GST: d[21],
                    TDS: d[20],
                    TransactionAmount: d[7],
                    CommissionAmount: d[22],
                    Quantity: d[10],
                    TotalAmount: d[11],
                    CardNumber: d[12],
                    CardPin: d[13],
                    AmazonReferenceNumber: d[14],
                    GiftMessage: d[15],
                    ResponseCode: d[16],
                    CardDesigncategoryName: d[17],
                    RedmilTransactionId: d[23],
                    CardDesignname: d[18],
                    OrderId: d[19],
                    DEName: d[24],
                    DEMobile: d[25],
                }

                // var result = requestDate + '\n' + requestTime + '\n' + caNumber + '\n' + billPayAmount + '\n' + billReferenceId + '\n' + redmilTransactionId + '\n' + walletType + '\n' + commissionAmount + '\n' + status;
            }
            else if (subCat == "1") {
                var billPaymentsModel = {
                    RequestDate: d[10],
                    RequestTime: d[11],
                    CustomerMobileNumber: d[6],
                    BillerCategory: d[1],
                    BillerName: d[2],
                    BillAmount: d[7],
                    Status: d[12],
                    BillerReferenceId: d[9],
                    RedmilTransactionId: d[14],
                    CCF: d[3],
                    CustomerInputField: d[4],
                    CustomerInputFieldValue: d[5],
                    DEName: d[15],
                    DEMobile: d[16],
                }

                // var result = requestDate + '\n' + requestTime + '\n' + caNumber + '\n' + billPayAmount + '\n' + billReferenceId + '\n' + redmilTransactionId + '\n' + walletType + '\n' + commissionAmount + '\n' + status;
            }
            else if (subCat == "3" || subCat == "4" || subCat == "2") {
                var mobilePrepaidPostpaid = {
                    RequestDate: d[1],
                    RequestTime: d[2],
                    CustomerMobile: d[3],
                    OperatorName: d[4],
                    CustomerID: d[11],
                    Status: d[6],
                    Amount: d[5],
                    RedmilTransactionId: d[9],
                    OperatorTransactionId: d[10],
                    DEMobile: d[11],
                    DEName: d[12],

                }
            }
            else if (subCat == "5") {
                var licPremiumPaymentsModel = {
                    RequestDate: d[1],
                    RequestTime: d[2],
                    caNumber: d[3],
                    Status: d[4],
                    BillPayAmount: d[6],
                    BillReferenceId: d[8],
                    RedmilTransactionId: d[9],
                    DEMobile: d[11],
                    DEName: d[12],
                }
            }

            var result = {

                "AePSCashWithdrawalModel": aePSCashWithdrawalModel,   //loginModel same name as in Modal
                "MicroATMCashWithdrawalModel": microATMCashWithdrawalModel,   //registerModel same name as in Modal
                "FinoDMTModel": finoDMTModel,
                "CreditScoreModel": creditScoreModel,
                "LICPremiumPaymentsModel": licPremiumPaymentsModel,
                "MicroATMBalanceEnquiryModel": microATMBalanceEnquiryModel,
                "YBLDomesticMoneyTransferModel": yBLDomesticMoneyTransferModel,
                "GoldInvestmentBuyModel1": goldInvestmentBuyModel1,
                "GoldInvestmentSellModel1": goldInvestmentSellModel1,
                "AmazonPayGiftCardModel": amazonPayGiftCardModel,
                "MobilePrepaidPostpaid": mobilePrepaidPostpaid,
                "BillPaymentsModel": billPaymentsModel,
                //"MobilePrepaidRequestModel": mobilePrepaidRequestModel,
                //"DTHRechargeModel": dthRechargeModel,

            }
            $.ajax({

                type: "POST",
                url: "/MyBusinessReports/ViewReceipt",
                data: { result, subCat },
                dataType: 'json',
                success: function (msgdeserialize) {
                    if (msgdeserialize.result == "EmptyResult") {
                        window.location.href = msgdeserialize.url;
                    }
                    else if (msgdeserialize.result == "UnExpectedStatusCode") {
                        window.location.href = msgdeserialize.url;

                    }
                    else if (msgdeserialize.result == "RedirectToException") {
                        window.location.href = msgdeserialize.url;
                    }
                    else {
                        var viewReceipt = msgdeserialize;
                        var viewReceiptWindow = window.open();
                        viewReceiptWindow.document.write(viewReceipt);
                        viewReceiptWindow.print();
                    }

                },
                failure: function (msgdeserialize) {
                    alert(msgdeserialize.responseText);
                },
                error: function (msgdeserialize) {
                    alert(msgdeserialize.responseText);
                }
            });

        });
    });
</script>
